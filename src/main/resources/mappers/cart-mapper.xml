<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cartMapper">

<select id="selectCartList"  resultType="Cart" >

select *
from cart
where id = #{loginUserId}

<!-- select *
from member
where userid = #{loginUserId} -->

</select>

	<resultMap type="Cart" id="CartResultMap">
		<id property="cNo" column="CNO"/>
		<result property="cName" column="CNAME"/>
		<result property="cAmount" column="CAMOUNT"/>
		<result property="cPrice" column="CPRICE"/>
		<result property="cCreateDate" column="CCREATEDATE"/>
		<result property="p_id" column="P_ID"/>
		<result property="id" column="ID"/>

	</resultMap>
	

	<update id="updateAmount" parameterType="map" >
	
	
	update cart
	set camount = #{amount}
	where cno = #{no}
	
	</update>
	
	<delete id="delCart" parameterType="String">
	
	delete cart
	where cno = #{cNo}
	
	</delete>
	
	
	<select id="cartPaymentList" resultType="Cart" parameterType="map">
	
	select *
	from cart
	where cno in
	<foreach collection="totalArr" item="tArr" index="index"  open="(" close=")" separator=",">
	#{tArr}
	</foreach>

	
	
	</select>
	
	<select id="insertPayment" parameterType="map">
	
	
INSERT INTO PAYMENT_PRODUCT( PNO,PPNO,PNAME,PAMOUNT,PPRICE,PCREATEDATE,ID,TOTALPRICE)
SELECT SEQ_PRODUCT.NEXTVAL AS PNO,<foreach collection="hitPno" item ="hit" index="index">#{hit}</foreach> AS PPNO,CNAME,CAMOUNT,CPRICE,SYSDATE AS PCREATEDATE ,ID,

<foreach collection="total" item ="tt" index="index">#{tt}</foreach>
 AS TOTALPRICE
FROM CART
WHERE CNO in
	<foreach collection="totalArr" item="tArr" index="index"  open="(" close=")" separator=",">
	#{tArr}
	</foreach>
	
	
	</select>
	
	
	<select id="PaymentInsertDB" parameterType="Payment">
	
INSERT INTO PAYMENT VALUES(SEQ_PAYMENT.NEXTVAL,#{userid},#{p_id},#{payname},#{payphone},#{paycellphone},#{payemail},#{receiverName},#{receiverPhone},#{receiverCellPhone}
,#{payprice},#{orderMemo},sysdate,#{delivaryDate},#{payrecipe},#{payaddress},default)
	
	</select>
	
	
	<delete id="delCartNum" >
	
	DELETE FROM CART 
	WHERE CNO IN
	<foreach collection="totalArr" item="tArr" index="index"  open="(" close=")" separator=",">
	#{tArr}
	</foreach>
	
	</delete>
	
	
	<select id="selectPayMem" parameterType="Payment" resultType="Payment">
	SELECT *
	FROM PAYMENT
	WHERE P_ID = #{checkno}
	
	</select>
	


</mapper>
